<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Merkle-Integrity Signature Extension for Responses</title>

  <style type="text/css">/*<![CDATA[*/
@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}

@media screen and (min-width: 1024px) {
  ul.toc, #rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    padding: 0 1em;
    z-index: 1;
  }
  #rfc\.toc {
    top: 16px;
  }
  ul.toc {
    top: 80px;
    overflow: auto;
  }

  body {
    padding-left: 1.5em;
    padding-right: 29em;
  }
}

body {
  font: 15px "Helvetica Neue",Helvetica,Arial,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 130%;
  margin: 2.5em auto;
  max-width: 724px;
}

.title, .filename, h1, h2, h3, h4 {
  font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size-adjust: 0.5;
  font-weight: 500;
  color: #333;
  line-height: 100%;
  margin: 0.8em 0 0.3em;
}
.title { font-size: 36px; }
h1 { font-size: 30px; }
h2 { font-size: 24px; }
h3, h4 { font-size: 18px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

ul.toc li {
  list-style: none;
  text-indent: -2.5em;
  padding-left: 2.5em;
  padding-bottom: 5px;
  margin: 0;
}
ul.toc, ul.toc ul {
  margin: 0 0 0 1.5em;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header {
  width: 100%;
}
table.header td {
  border: none;
  background-color: transparent;
  color: black;
}
.filename {
  color: rgb(119, 119, 119);
  font-size: 23px;
  font-weight: normal;
  height: auto;
  line-height: 100%;
}
#rfc\.abstract+p {
  font-size: 20px;
  font-weight: 300;
  line-height: 130%;
}

samp, tt, code, pre {
  font: 11pt consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure {
  font-style: italic;
  margin: 0 1.5em;
}

address {
  margin: 10px 0 0;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn {
  font-weight: bold;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

ol, ul, li, p {
  padding: 0;
  margin: 0.5em 0 0.5em 2em;
}
li, p {
  margin-left: 0;
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Signature Limitations"/>
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Terminology"/>
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Example"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Signature Usage"/>
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 URI Normalization"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Identifying and Describing Signature Keys"/>
<link href="#rfc.section.4" rel="Chapter" title="4 Security Considerations"/>
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations"/>
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Additions to the MI Parameter Registry"/>
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Additions to the Crypto-Key Parameter Registry"/>
<link href="#rfc.references" rel="Chapter" title="6 References"/>
<link href="#rfc.references.1" rel="Chapter" title="6.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="6.2 Informative References"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.5.1 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Thomson, M." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-thomson-http-miser-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2016-6-30" />
  <meta name="dct.abstract" content="Use of a signature is described to provide integrity for the content of HTTP responses.  Content can be progressively processed without losing integrity if a client is prepared to accept the risk of truncation." />
  <meta name="description" content="Use of a signature is described to provide integrity for the content of HTTP responses.  Content can be progressively processed without losing integrity if a client is prepared to accept the risk of truncation." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">httpbis</td>
  <td class="right">M. Thomson</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">Mozilla</td>
</tr>
<tr>
  <td class="left">Intended status: Informational</td>
  <td class="right">June 30, 2016</td>
</tr>
<tr>
  <td class="left">Expires: January 1, 2017</td>
  <td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Merkle-Integrity Signature Extension for Responses<br />
  <span class="filename">draft-thomson-http-miser-latest</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>Use of a signature is described to provide integrity for the content of HTTP responses.  Content can be progressively processed without losing integrity if a client is prepared to accept the risk of truncation.</p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 1, 2017.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2016 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Signature Limitations</a></li>
<li>1.2.   <a href="#rfc.section.1.2">Terminology</a></li>
<li>1.3.   <a href="#rfc.section.1.3">Example</a></li>
</ul><li>2.   <a href="#rfc.section.2">Signature Usage</a></li>
<ul><li>2.1.   <a href="#rfc.section.2.1">URI Normalization</a></li>
</ul><li>3.   <a href="#rfc.section.3">Identifying and Describing Signature Keys</a></li>
<li>4.   <a href="#rfc.section.4">Security Considerations</a></li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a></li>
<ul><li>5.1.   <a href="#rfc.section.5.1">Additions to the MI Parameter Registry</a></li>
<li>5.2.   <a href="#rfc.section.5.2">Additions to the Crypto-Key Parameter Registry</a></li>
</ul><li>6.   <a href="#rfc.references">References</a></li>
<ul><li>6.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>6.2.   <a href="#rfc.references.2">Informative References</a></li>
</ul><li><a href="#rfc.authors">Author's Address</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> <a href="#problems" id="problems">Introduction</a></h1>
<p id="rfc.section.1.p.1">A scheme for providing integrity for the content of HTTP messages is described in <a href="#I-D.thomson-http-mice">[I-D.thomson-http-mice]</a>.  That scheme permits a recipient to process the content of a message without having to receive the entire message.  Though the content might subsequently be truncated, the partial content that is received is known to be correct.  This is similar to the integrity guarantee provided by HTTPS <a href="#RFC2818">[RFC2818]</a>.</p>
<p id="rfc.section.1.p.2">The major drawback of any integrity scheme that it is not possible to prime a recipient with any information that would allow them to make a decision regarding content that isn&#8217;t yet known.  Thus, for example, it is impossible to construct an integrity protected reference such as the one described in <a href="#SRI">[SRI]</a> without first knowing the precise details of the content that is being referred to.</p>
<p id="rfc.section.1.p.3">A signature-based integrity scheme avoids this problem by allowing a recipient to be given a signature public key that can be used to verify the integrity of message content.  This allows a reference to be constructed prior to generating dynamic content.  More generally, it makes it possible to provide an integrity-protected reference to content without having to know the specific content of what is being referred to.</p>
<h1 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a> <a href="#signature-limitations" id="signature-limitations">Signature Limitations</a></h1>
<p id="rfc.section.1.1.p.1">Signature-based schemes do have several downsides that need to be carefully considered.</p>
<p/>

<ul>
  <li>Signatures can be constructed in a way that permits unwanted portability of content.  If the same key is used to sign the content of multiple messages, the content of one message could be switched for the content of another message.</li>
  <li>Signatures are also not bound to a particular key; given a message signed with one key, it is possible that another key could be found that appears to have produced the signature.  This might be used to falsely claim the contents of a signed message.</li>
  <li>Signatures - when combined with encryption - create deceptive properties.  A message that is both signed by a particular sender and encrypted toward a particular recipient does not imply that the message was originally constructed by that sender to be sent to that recipient.  If separately applied, the outermost signature or encryption can be replaced <a href="#DAVIS">[DAVIS]</a>.</li>
</ul>
<p id="rfc.section.1.1.p.3">This document defines a signature scheme with a narrow scope, the intent being to provide the ability to use signatures for integrity protection without running afoul of the many pitfalls of previous attempts at signing HTTP messages or content.</p>
<p id="rfc.section.1.1.p.4">In particular, this document only describes how the content of an HTTP response is signed.</p>
<p id="rfc.section.1.1.p.5">ISSUE: Should this further limit the signature to responses to GET requests?  In looking at the various ways in which these signatures can be transplanted, limiting in this way would avoid problems with different requests.  Since most requests can be trivially parlayed into a GET request, this doesn&#8217;t seem like an unbearable restriction on use.</p>
<p id="rfc.section.1.1.p.6">ISSUE: SHOULD this also prohibit content negotiation?  That the signatures on XML and JSON variants of responses to the same resource are interchangeable doesn&#8217;t seem obviously exploitable, but not all changes in response to content negotiation are so clearly delineated.</p>
<h1 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2.</a> <a href="#Terminology" id="Terminology">Terminology</a></h1>
<p id="rfc.section.1.2.p.1">RFC 2119 <a href="#RFC2119">[RFC2119]</a> defines the terms MUST, SHOULD, and MAY.</p>
<h1 id="rfc.section.1.3"><a href="#rfc.section.1.3">1.3.</a> <a href="#example" id="example">Example</a></h1>
<p id="rfc.section.1.3.p.1">The following shows an HTTP/1.1 response to a request to <samp>https://example.com/hello</samp>.</p>
<pre>
HTTP/1.1 200 OK
Date: Wed, 29 Jun 2016 01:16:02 GMT
Content-Length: 15
Crypto-Key: keyid=a;
    p256ecdsa=BLqanccr81i6vKOl3cUpc5GyxeGP4A05DtsxNLMGtzqV
              KzIUmJz3rQNUgMZc8gv7fk0xQJ80BVnrjW4VifawAZ8
MI: keyid=a;
    p256ecdsa=iPn7MWjD7nCcnq6OJn2nTYbKyYhj3IB1ngmsiatFiARh
              zqVsuaH7KsB2et2PCX33SDX6ZlEges_wDiPkIp5zqA

Hello, World!
</pre>
<p id="rfc.section.1.3.p.2">Line wrapping is added to this example to fit formatting constraints.  The omitted <samp>p</samp> attribute for this example is included in <a href="#I-D.thomson-http-mice">[I-D.thomson-http-mice]</a>.</p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#sig" id="sig">Signature Usage</a></h1>
<p id="rfc.section.2.p.1">A signature uses the MI header field defined in <a href="#I-D.thomson-http-mice">[I-D.thomson-http-mice]</a>.  A new <samp>p256ecdsa</samp> parameter is defined that carries an ECDSA <a href="#X9.62">[X9.62]</a> signature over the P-256 curve <a href="#FIPS186">[FIPS186]</a> using the SHA-256 hash <a href="#FIPS180-2">[FIPS180-2]</a>.  The signature is encoded in the parameter using base64url encoding <a href="#RFC7515">[RFC7515]</a>.</p>
<p id="rfc.section.2.p.2">The input to the signature is the concatenation of:</p>
<p/>

<ul>
  <li>the UTF-8 <a href="#RFC3629">[RFC3629]</a> encoded string &#8220;MI: p256ecdsa&#8221;,</li>
  <li>a single zero-valued octet,</li>
  <li>the octets of the effective request URI (Section 5.5 of <a href="#RFC7230">[RFC7230]</a>),</li>
  <li>a single zero-valued octet, and</li>
  <li>the &#8220;mi-sha256&#8221; root integrity proof for the content <a href="#I-D.thomson-http-mice">[I-D.thomson-http-mice]</a>.</li>
</ul>
<p id="rfc.section.2.p.4">The <samp>p256ecdsa</samp> field contains the concatenated bitstrings of the R and S outputs of the ECDSA signature algorithm.</p>
<p id="rfc.section.2.p.5">If a recipient is expected to use the signature to validate content, the <samp>p256ecdsa</samp> parameter can replace the <samp>p</samp> parameter of the MI header field.  Both parameters MAY be included, though both should agree.</p>
<p id="rfc.section.2.p.6">Signatures MUST NOT be used to protect the content of a request.  Clients frequently make multiple requests of the same resource with different header fields and content.  Relying on signatures for requests could allow attacks where content from one request is interchanged with other requests to the same resource.</p>
<h1 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a> <a href="#uri-normalization" id="uri-normalization">URI Normalization</a></h1>
<p id="rfc.section.2.1.p.1">The consequence of including the effective request URI under the signature is that the signature is exposed to the vagaries of URI encoding.  Though two URIs might be considered equivalent, differences in the encoding of those URIs will produce different signatures.</p>
<p id="rfc.section.2.1.p.2">A potential approach to this problem has the server signal the precise encoding that it used to produce the signature.  However, this changes the problem from a normalization problem to a comparison problem.  A client that fails to correctly compare their effective request URI with the claimed URI could be exposed to attacks where the content of resources with similar URIs are interchanged.  A client cannot know that a server will consider two different URI encodings to be identical.</p>
<p id="rfc.section.2.1.p.3">Thus, a normalization scheme specific to <samp>https://</samp> URIs is defined, based on the recommendations in <a href="#RFC7230">[RFC7230]</a> and <a href="#RFC3986">[RFC3986]</a>.  Use of signatures with other URI schemes is not defined.  The following transformations are made to the effective request URI, with reference to the corresponding part of Section 6.2 of <a href="#RFC3986">[RFC3986]</a>:</p>
<p/>

<ul>
  <li>The <samp>https://</samp> scheme is rendered in lower case (S6.2.2.1)</li>
  <li>A domain name is encoded as lower case A-Labels (S6.2.2.1)</li>
  <li>An IPv4 literal is represented in dotted decimal notation without additional leading zeroes</li>
  <li>An IPv6 literal is represented according to the canonical form defined in <a href="#RFC5952">[RFC5952]</a></li>
  <li>A port number is included without leading zeros; the colon and port are omitted entirely if the port number is 443 (S6.2.3)</li>
  <li>Percent-encoded of characters in the host component are decoded; non-reserved characters in the path and query components are decoded (S6.2.2.2)</li>
  <li>Path segments containing &#8220;.&#8221; and &#8220;..&#8221; are normalized (S6.2.2.3)</li>
  <li>An empty path segment is replaced with a &#8220;/&#8221; (S6.2.3)</li>
</ul>
<p id="rfc.section.2.1.p.5">Note that an effective request URI does not contain a fragment.</p>
<p id="rfc.section.2.1.p.6">Unfortunately, devising a perfect normalization scheme for all <samp>https://</samp> URIs isn&#8217;t possible, since servers could apply additional rules for determining URI equivalance that are context-specific.</p>
<p id="rfc.section.2.1.p.7">Clients that encounter signature failures MAY attempt to re-acquire resources by passing the normalized effective request URI in a request that uses the absolute-form (see Section 5.3.2 of <a href="#RFC7230">[RFC7230]</a>).</p>
<p id="rfc.section.2.1.p.8">Servers that receive a request in the absolute-form SHOULD use the octets provided by the client as input as input to the above normalization procedure when producing a signature.  In other words, servers that permit a range of possible URI encodings to identify the same logical resource might need to produce multiple signatures for that resource depending on how a client requests that resource.</p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#keys" id="keys">Identifying and Describing Signature Keys</a></h1>
<p id="rfc.section.3.p.1">A <samp>keyid</samp> parameter is added for use with the MI header field.  This allows a recipient to identify the key that can be used to validate the signature in the <samp>p256ecdsa</samp> parameter.  The <samp>keyid</samp> SHOULD match a value in the Crypto-Key header field <a href="#I-D.ietf-httpbis-encryption-encoding">[I-D.ietf-httpbis-encryption-encoding]</a> if that header field is is used.</p>
<p id="rfc.section.3.p.2">Providing a signature key is typically only useful where the provision of the key can be attributed a higher level of trust than the signature itself.  A message sent using out-of-band content-encoding <a href="#I-D.reschke-http-oob-encoding">[I-D.reschke-http-oob-encoding]</a> is one situation that might benefit from the use of this header field.</p>
<p id="rfc.section.3.p.3">This document defines a new parameter for use with the Crypto-Key header field.  The <samp>p256ecdsa</samp> parameter conveys an uncompressed P-256 public key <a href="#X9.62">[X9.62]</a>.  The <samp>p256ecdsa</samp> parameter for the Crypto-Key header field is encoded using base64url encoding <a href="#RFC7515">[RFC7515]</a>.</p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#security" id="security">Security Considerations</a></h1>
<p id="rfc.section.4.p.1">Determining whether a signature is valid is only a small part of authenticating a response.  This document doesn&#8217;t describe a complete solution for identifying which signing keys are accepted.</p>
<p id="rfc.section.4.p.2">The signature does not authenticate header fields or any part of the request.  The signature only covers the effective request URI, which is to prevent signed content from being replayed for responses to other URIs.  A recipient of a signed payload needs to be especially careful that decisions that rely on authenticating the payload do not take any unauthenticated material as input.  In particular, the <samp>Content-Type</samp> header field are not authenticated by this scheme.</p>
<p id="rfc.section.4.p.3">No replay protection is offered for signatures.  This means that valid messages can be captured and replayed.  The only restriction is that they are limited to responses for the same URI.  The following changes are not detectable based on the signature:</p>
<p/>

<ul>
  <li>The signature does not include details of the request, therefore contents of responses that depend on requests are interchangeable.</li>
  <li>The signature does not include header fields in the response, therefore any arrangement of header fields might be attached to signed content.</li>
  <li>The signature is not bound to a particular time, therefore responses can be replayed at other times.</li>
</ul>
<p id="rfc.section.4.p.5">In particular, if content negotiation (see Section 3.4 of <a href="#RFC7231">[RFC7231]</a>) is used, then all alternative representations for a given URI will all have valid signatures.  For this reason, servers SHOULD avoid combining content negotiation with signatures.</p>
<p id="rfc.section.4.p.6">A recipient of encrypted <a href="#I-D.ietf-httpbis-encryption-encoding">[I-D.ietf-httpbis-encryption-encoding]</a> content that is also signed, cannot assume that the encrypted content was originally generated by the holder of the signing key.  A signature might be applied to encrypted content without knowing its contents.  For a similar reason, an encrypted message might not have been originally sent to the holder of the decryption keys.  More generally, a recipient of encrypted HTTP response content cannot assume that the message was encrypted specifically for them.</p>
<p id="rfc.section.4.p.7">A key used to sign response content MUST NOT be used for other purposes.  A key SHOULD also be used over a limited scope and time.  A key might be limited to use with a single request.</p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#iana" id="iana">IANA Considerations</a></h1>
<h1 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1.</a> <a href="#additions-to-the-mi-parameter-registry" id="additions-to-the-mi-parameter-registry">Additions to the MI Parameter Registry</a></h1>
<p id="rfc.section.5.1.p.1">This memo registers the <samp>p256ecdsa</samp> and <samp>keyid</samp> in the &#8220;Hypertext Transfer Protocol (HTTP) MI Parameters&#8221; registry established in <a href="#I-D.thomson-http-mice">[I-D.thomson-http-mice]</a>.</p>
<p id="rfc.section.5.1.p.2">For <samp>keyid</samp>:</p>
<p/>

<ul>
  <li>Parameter Name: keyid</li>
  <li>Purpose: Identify the key that is in use.</li>
  <li>Reference: <a href="#keys">Section 3</a> of this document</li>
</ul>
<p id="rfc.section.5.1.p.4">For <samp>p256ecdsa</samp>:</p>
<p/>

<ul>
  <li>Parameter Name: p256ecdsa</li>
  <li>Purpose: Conveys a signature over the <samp>p</samp> parameter using P-256, ECDSA and SHA-256.</li>
  <li>Reference: <a href="#sig">Section 2</a> of this document</li>
</ul>
<h1 id="rfc.section.5.2"><a href="#rfc.section.5.2">5.2.</a> <a href="#additions-to-the-crypto-key-parameter-registry" id="additions-to-the-crypto-key-parameter-registry">Additions to the Crypto-Key Parameter Registry</a></h1>
<p id="rfc.section.5.2.p.1">This memo registers the <samp>p256ecdsa</samp> and <samp>keyid</samp> in the &#8220;Hypertext Transfer Protocol (HTTP) Crypto-Key Parameters&#8221; registry established in <a href="#I-D.ietf-httpbis-encryption-encoding">[I-D.ietf-httpbis-encryption-encoding]</a>.</p>
<p/>

<ul>
  <li>Parameter Name: p256ecdsa</li>
  <li>Purpose: Conveys a signing key for use with the parameter of the same name on the <samp>Content-Signature</samp> header field.</li>
  <li>Reference: <a href="#keys">Section 3</a> of this document</li>
</ul>
<h1 id="rfc.references"><a href="#rfc.references">6.</a> References</h1>
<h1 id="rfc.references.1"><a href="#rfc.references.1">6.1.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="FIPS180-2">[FIPS180-2]</b>
      </td>
      <td class="top"><a>Department of Commerce, National.</a>, "<a>NIST FIPS 180-2, Secure Hash Standard</a>", August 2002.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="FIPS186">[FIPS186]</b>
      </td>
      <td class="top"><a>National Institute of Standards and Technology (NIST)</a>, "<a>Digital Signature Standard (DSS)</a>", NIST PUB 186-4 , July 2013.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.ietf-httpbis-encryption-encoding">[I-D.ietf-httpbis-encryption-encoding]</b>
      </td>
      <td class="top"><a>Thomson, M.</a>, "<a href="http://tools.ietf.org/html/draft-ietf-httpbis-encryption-encoding-01">Encrypted Content-Encoding for HTTP</a>", Internet-Draft draft-ietf-httpbis-encryption-encoding-01, March 2016.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.thomson-http-mice">[I-D.thomson-http-mice]</b>
      </td>
      <td class="top"><a>Thomson, M.</a>, "<a href="http://tools.ietf.org/html/draft-thomson-http-mice-00">Merkle Integrity Content Encoding</a>", Internet-Draft draft-thomson-http-mice-00, January 2016.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3629">[RFC3629]</b>
      </td>
      <td class="top"><a>Yergeau, F.</a>, "<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>", STD 63, RFC 3629, DOI 10.17487/RFC3629, November 2003.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3986">[RFC3986]</b>
      </td>
      <td class="top"><a>Berners-Lee, T.</a>, <a>Fielding, R.</a> and <a>L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, DOI 10.17487/RFC3986, January 2005.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5952">[RFC5952]</b>
      </td>
      <td class="top"><a>Kawamura, S.</a> and <a>M. Kawashima</a>, "<a href="http://tools.ietf.org/html/rfc5952">A Recommendation for IPv6 Address Text Representation</a>", RFC 5952, DOI 10.17487/RFC5952, August 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7230">[RFC7230]</b>
      </td>
      <td class="top"><a>Fielding, R.</a> and <a>J. Reschke</a>, "<a href="http://tools.ietf.org/html/rfc7230">Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</a>", RFC 7230, DOI 10.17487/RFC7230, June 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7515">[RFC7515]</b>
      </td>
      <td class="top"><a>Jones, M.</a>, <a>Bradley, J.</a> and <a>N. Sakimura</a>, "<a href="http://tools.ietf.org/html/rfc7515">JSON Web Signature (JWS)</a>", RFC 7515, DOI 10.17487/RFC7515, May 2015.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="X9.62">[X9.62]</b>
      </td>
      <td class="top"><a>ANSI</a>, "<a>Public Key Cryptography For The Financial Services Industry: The Elliptic Curve Digital Signature Algorithm (ECDSA)</a>", ANSI X9.62 , 1998.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.references.2"><a href="#rfc.references.2">6.2.</a> Informative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="DAVIS">[DAVIS]</b>
      </td>
      <td class="top"><a>Davis, D.</a>, "<a href="http://world.std.com/~dtd/sign_encrypt/sign_encrypt7.html">Defective Sign &amp; Encrypt in S/MIME, PKCS#7, MOSS, PEM, PGP, and XML</a>", May 2001.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.reschke-http-oob-encoding">[I-D.reschke-http-oob-encoding]</b>
      </td>
      <td class="top"><a>Reschke, J.</a> and <a>S. Loreto</a>, "<a href="http://tools.ietf.org/html/draft-reschke-http-oob-encoding-06">'Out-Of-Band' Content Coding for HTTP</a>", Internet-Draft draft-reschke-http-oob-encoding-06, April 2016.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2818">[RFC2818]</b>
      </td>
      <td class="top"><a>Rescorla, E.</a>, "<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>", RFC 2818, DOI 10.17487/RFC2818, May 2000.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7231">[RFC7231]</b>
      </td>
      <td class="top"><a>Fielding, R.</a> and <a>J. Reschke</a>, "<a href="http://tools.ietf.org/html/rfc7231">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</a>", RFC 7231, DOI 10.17487/RFC7231, June 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="SRI">[SRI]</b>
      </td>
      <td class="top"><a>Akhawe, D.</a>, <a>Braun, F.</a>, <a>Marier, F.</a> and <a>J. Weinberger</a>, "<a href="https://w3c.github.io/webappsec-subresource-integrity/">Subresource Integrity</a>", W3C CR , November 2015.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Author's Address</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Martin Thomson</span> 
	  <span class="n hidden">
		<span class="family-name">Thomson</span>
	  </span>
	</span>
	<span class="org vcardline">Mozilla</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:martin.thomson@gmail.com">martin.thomson@gmail.com</a></span>

  </address>
</div>

  <div class="github-fork-ribbon-wrapper"><div class="github-fork-ribbon"><a href="https://github.com/martinthomson/http-miser">Fork me on GitHub</a></div></div>
</body>
</html>
